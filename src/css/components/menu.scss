// Import shared spacing and breakpoint variables from text
@use "../theme/colors" as colors;

// Structural Variables - Core layout that rarely changes
$menu-display: flex !default;
$menu-justify: flex-end !default;
$menu-align: center !default;
$menu-position: relative !default;
$menu-button-height-ratio: 0.8 !default;
$menu-button-position: relative !default;
$menu-line-position: absolute !default;
$menu-line-rotate-angle: 45deg !default;
$menu-list-display: flex !default;
$menu-list-style: none !default;
$menu-mobile-position: fixed !default;
$menu-mobile-initial-right: -100% !default;
$menu-mobile-open-right: 0 !default;
$menu-mobile-top: 0 !default;
$menu-mobile-z-index: 2 !default;
$menu-button-z-index: 3 !default;

// Theme Variables - Colors and sizes that might change with theming
$menu-line-color: colors.color("text") !default;
$menu-background: colors.color("background") !default;

// Responsive sizes with clamp
$menu-padding: clamp(0.5rem, 2vw, 1.2rem) clamp(0.75rem, 3vw, 2rem) !default;
$menu-small-padding: clamp(0.3rem, 1.5vw, 0.8rem) clamp(0.5rem, 2vw, 1rem) !default;
$menu-button-size-min: 24px !default;
$menu-button-size-max: 36px !default;
$menu-line-thickness: 3px !default;
$menu-item-spacing: clamp(0.75rem, 2vw, 1.5rem) !default;
$menu-font-size: clamp(0.9rem, calc(0.85rem + 0.5vw), 1.1rem) !default;
$menu-mobile-width: clamp(250px, 70%, 400px) !default;
$menu-small-width: clamp(200px, 85%, 300px) !default;
$menu-mobile-padding-top: clamp(2rem, calc(2rem + 2vh), 4rem) !default;
$menu-mobile-item-padding: clamp(0.4rem, calc(0.25rem + 1vh), 0.75rem) 0 !default;

// Button size variables
$menu-button-width: clamp(
  #{$menu-button-size-min},
  calc((#{$menu-button-size-min} - 4px) + 1.5vw),
  #{$menu-button-size-max}
) !default;
$menu-button-height: clamp(
  calc(#{$menu-button-size-min} * #{$menu-button-height-ratio}),
  calc((#{$menu-button-size-min} * #{$menu-button-height-ratio} - 4px) + 1.5vw),
  calc(#{$menu-button-size-max} * #{$menu-button-height-ratio})
) !default;

// Transitions
$menu-line-transition: transform 0.25s ease-in-out, opacity 0.2s ease !default;
$menu-mobile-transition: right 0.3s ease !default;

// Dark mode variables
$menu-line-color-dark: #eee !default;
$menu-background-dark: #222 !default;

// Responsive Breakpoints
$menu-mobile-breakpoint: 768px !default;
$menu-small-breakpoint: 480px !default;

// Base Header Styling - Minimum required for functionality
.menu {
  display: var(--menu-display, #{$menu-display});
  justify-content: var(--menu-justify, #{$menu-justify});
  align-items: var(--menu-align, #{$menu-align});
  position: var(--menu-position, #{$menu-position});
  padding: var(--menu-padding, #{$menu-padding});

  input {
    position: var(--menu-input-position, absolute);
    opacity: var(--menu-input-opacity, 0);
    pointer-events: var(--menu-input-pointer-events, none);
  }

  label {
    display: var(--menu-label-display, none);
    cursor: var(--menu-label-cursor, pointer);
    z-index: var(--menu-button-z-index, #{$menu-button-z-index});
    width: var(--menu-button-width, #{$menu-button-width});
    height: var(--menu-button-height, #{$menu-button-height});
    position: var(--menu-button-position, #{$menu-button-position});

    span {
      display: var(--menu-line-display, block);
      position: var(--menu-line-position, #{$menu-line-position});
      height: var(--menu-line-thickness, #{$menu-line-thickness});
      width: var(--menu-line-width, 100%);
      background-color: var(--menu-line-color, #{$menu-line-color});
      left: var(--menu-line-left, 0);
      transition: var(--menu-line-transition, #{$menu-line-transition});

      &:nth-child(1) {
        top: var(--menu-line-1-top, 0);
      }

      &:nth-child(2) {
        top: var(--menu-line-2-top, 50%);
        transform: var(--menu-line-2-transform, translateY(-50%));
      }

      &:nth-child(3) {
        bottom: var(--menu-line-3-bottom, 0);
      }
    }
  }

  nav ul {
    display: var(--menu-list-display, #{$menu-list-display});
    list-style: var(--menu-list-style, #{$menu-list-style});
    margin: var(--menu-list-margin, 0);
    padding: var(--menu-list-padding, 0);

    li {
      margin-left: var(--menu-item-spacing, #{$menu-item-spacing});

      a {
        font-size: var(--menu-font-size, #{$menu-font-size});
      }
    }
  }

  @media (max-width: #{$menu-mobile-breakpoint}) {
    label {
      display: var(--menu-mobile-label-display, flex);
      flex-direction: var(--menu-mobile-label-direction, column);
      justify-content: var(--menu-mobile-label-justify, space-between);
    }

    nav {
      position: var(--menu-mobile-position, #{$menu-mobile-position});
      top: var(--menu-mobile-top, #{$menu-mobile-top});
      right: var(--menu-mobile-initial-right, #{$menu-mobile-initial-right});
      width: var(--menu-mobile-width, #{$menu-mobile-width});
      height: var(--menu-mobile-height, 100vh);
      z-index: var(--menu-mobile-z-index, #{$menu-mobile-z-index});
      padding-top: var(--menu-mobile-padding-top, #{$menu-mobile-padding-top});
      background-color: var(--menu-background, #{$menu-background});
      transition: var(--menu-mobile-transition, #{$menu-mobile-transition});

      ul {
        flex-direction: var(--menu-mobile-list-direction, column);

        li {
          margin: var(--menu-mobile-item-margin, 0);
          padding: var(
            --menu-mobile-item-padding,
            #{$menu-mobile-item-padding}
          );
        }
      }
    }

    input:checked ~ nav {
      right: var(--menu-mobile-open-right, #{$menu-mobile-open-right});
    }

    input:checked ~ label span {
      &:nth-child(1) {
        top: var(--menu-checked-line-1-top, 50%);
        transform: var(
          --menu-checked-line-1-transform,
          translateY(-50%) rotate(#{$menu-line-rotate-angle})
        );
      }

      &:nth-child(2) {
        opacity: var(--menu-checked-line-2-opacity, 0);
      }

      &:nth-child(3) {
        bottom: var(--menu-checked-line-3-bottom, 50%);
        transform: var(
          --menu-checked-line-3-transform,
          translateY(50%) rotate(-#{$menu-line-rotate-angle})
        );
      }
    }
  }

  @media (max-width: #{$menu-small-breakpoint}) {
    padding: var(--menu-small-padding, #{$menu-small-padding});

    nav {
      width: var(--menu-small-width, #{$menu-small-width});
    }
  }
}

// Dark mode theming - Only declare color variables that change
@media (prefers-color-scheme: dark) {
  .menu {
    label span {
      background-color: var(--menu-line-color-dark, #{$menu-line-color-dark});
    }

    nav {
      background-color: var(--menu-background-dark, #{$menu-background-dark});
    }
  }
}
